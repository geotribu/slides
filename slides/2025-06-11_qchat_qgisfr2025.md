---
date: 2025-06-11
title: QChat, un tchat dans QGIS et QField
transition: slide
theme: dark
---

## QChat

:speech_balloon: Un tchat dans QGIS et QField

![cat](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/cat.png){ height="250" }

**#QGISFR2025** - 11 Juin 2025 - Avignon

Guilhem Allaman - ![Logo mastodon](https://cdn.geotribu.fr/img/logos-icones/social/mastodon.png){ height="15" } [@guilhem_allaman@mapstodon.space](https://mapstodon.space/@guilhem_allaman)

[Geotribu](https://geotribu.fr/) - ![Logo mastodon](https://cdn.geotribu.fr/img/logos-icones/social/mastodon.png){ height="15" } [@geotribu@mapstodon.space](https://mapstodon.space/@geotribu)

[OPENGIS.ch](https://www.opengis.ch/) - ![Logo mastodon](https://cdn.geotribu.fr/img/logos-icones/social/mastodon.png){ height="15" } [@opengisch@fosstodon.org](https://fosstodon.org/@opengisch)

![Logo Geotribu](https://geotribu.fr/theme/assets/images/geotribu/logo_geotribu.png){ height="50" }![Logo OPENGIS.ch](https://i0.wp.com/www.opengis.ch/wp-content/uploads/2024/03/logo_opengisch_open-source-geoninjas.png?fit=1824%2C671&ssl=1){ height="50" }

----

## :question: Qchat: pr√©parez-vous ! :question:

Un quizz est pr√©vu en fin de s√©ance :wink:, comment participer ?

- Ouvrir QGIS et installez le plugin [`QTribu`](https://plugins.qgis.org/plugins/qtribu/)
- Ouvrir [`https://gischat.geotribu.net`](https://gischat.geotribu.net) dans un navigateur :

![QR code QChat web](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/gischat_web_qrcode.webp){ height="300" }

----

### QChat : comment √ßa a commenc√©

Un jour... En juillet 2024...

![Un jardin bien vert avec un chien au premier plan](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/garden.jpeg)

----

### :iphone: Coup de fil avec Julien Moura (complice de Geotribu)

- Et si on tchattait dans QField ?
- Et si on tchattait dans QField **et** dans QGIS ?
- Mais... Pourquoi, en fait !?
- Et pourquoi pas ?

Inutile, donc indispensable !

----

### Commen√ßons par un plugin QGIS

Le plugin QGIS [QTribu](https://plugins.qgis.org/plugins/qtribu/) existe d√©j√† :

- fonctionnel
- enregistr√© sur `plugins.qgis.org`
- CICD op√©rationnelle

![QTribu sur plugins.qgis.org](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/qtribu_qgis_plugin.png)

_Fun fact: le plugin QTribu a √©t√© cr√©√© un 1er avril..._

----

### Objectifs de QChat

- ajouter du fun dans QGIS
- s'amuser √† d√©velopper ce tchat
- rencontrer les sigistes les plus :fire: de ta r√©gion, ou √† l'autre bout du monde - Qt-inder‚Ñ¢
- ouvrir des nouveaux usages : support & assistance, √©changes entre bureau et terrain, etc.

----

### QChat au d√©but

- √âtudier les standards ouverts de chat d√©j√† existants (IRC, jabber, matrix...)  
-> Commen√ßons simple, "Keep it simple", [K.I.S.S.](https://en.wikipedia.org/wiki/KISS_principle) :kissing_heart:
- Ouvert et accessible pour tout un chacun  
-> T'as un QGIS -> Tu peux tchatter :speech_balloon:

----

### D√©veloppement du plugin QGIS QTribu

- Au d√©but: le m√©chanisme [`LISTEN`](https://www.postgresql.org/docs/current/sql-listen.html) / [`NOTIFY`](https://www.postgresql.org/docs/current/sql-notify.html) de PostgreSQL consid√©r√©
- Choix: connexions de websockets au server -> `QtWebSockets` disponible en `pyqgis` :thumbsup:
- Param√®tres [en utilisant le templater de plugins QGIS](https://oslandia.gitlab.io/qgis/template-qgis-plugin/)
- `QgsDockWidget` -> fluide et en parall√®le du canvas de QGIS

----

### Fonctionnalit√©s de QChat

- Envoyer des messages textes basiques
- Incarner _jusqu'au bout de ses ongles_ un _avatar_ (ic√¥nes natives de QGIS)
- Mentionner les autres avec `@jane_doe` / `@all`
- Notifications: barre des messages de QGIS, sons...
- Liker des messages :thumbsup:
- Partager des donn√©es vecteur l√©g√®res, des images, des screenshots de son QGIS, des SCR, des bbox...

----

### Serveur QChat

- "gischat": [d√©p√¥t sur GitHub](https://github.com/geotribu/gischat) #gischat
- En python avec _FastAPI_
- Dispatcher de websockets
- Pas de bases de donn√©es: simplement des websockets _stateless_ :kissing_heart:
- Image docker sur [DockerHub](https://hub.docker.com/r/gounux/gischat) et [GHCR](https://github.com/geotribu/gischat/pkgs/container/gischat)
- D√©ployable sur un serveur assez simplement  
-> 1 service + quelques variables d'environnement

----

### Syst√®me QChat

```mermaid
graph TD
    subgraph Clients QChat
        QGISA[üíª QChat QGIS 1]
        QGISB[üíª QChat QGIS 2]
        QFieldA[üì± QChat QField]
    end
    subgraph Serveur gischat
        WSDispatcher[üö† Websocket Dispatcher]
        WSStorage[üó≥Ô∏è Websocket Rooms Storage]
    end

    QGISA --> |1Ô∏è‚É£üëã Ouvre une connexion pour une room| WSDispatcher
    WSDispatcher --> |2Ô∏è‚É£‚úÖ Enregistre la connexion pour la room| WSStorage

    QGISB --> |3Ô∏è‚É£üì¶ Envoie un message dans une room| WSStorage
    WSStorage --> |4Ô∏è‚É£üì¶ Diffuse le message √† la room| QGISA
    WSStorage --> |5Ô∏è‚É£üì¶ Diffuse le message √† la room| QFieldA
```

----

### Instances de chat QChat / gischat

2 serveurs connus √† l'heure actuelle:

- `gischat.geotribu.net`
-> pour tout le monde, en anglais
- `gischat.geotribu.fr`
-> pour tout le monde, en fran√ßais

Aussi: :phone: [annuaire des instances connues et d√©couvrables](https://github.com/geotribu/gischat/blob/main/instances.json) sur le d√©p√¥t GitHub

----

### Plugin QChat pour QField

![√âcran du plugin QChat dans QField](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/ecran_qchat_qfield_plugin.webp){ height="500" }

:thumbsup: Cr√©dits √† Mathieu Pellerin - [@nirvn](https://github.com/nirvn)

----

### QField Plugins Framework

_Live_ depuis Juillet 2024 :

- Ajouter de la logique custom et m√©tier √† l'app QField :
  - √Ä l'√©chelle d'un projet, d√©ployable avec QFieldCloud
  - √Ä l'√©chelle de l'application (param√®tres)
- D√©veloppement en JavaScript / QML ([_Qt Meta-object Language_](https://doc.qt.io/qt-6/qtqml-index.html))

----

### Plugins QField: exemple - 1/3

- [OSRM Routing plugin](https://github.com/opengisch/qfield-osrm)

![√âcran du plugin OSRM Routing Plugin dans QField](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/qfield_plugin_osrm_routing.webp){ height="400" }

- Calculer un plus court chemin avec l'API OSRM (OpenStreetMap Germany)
- -> dynamique -> appel et requ√™tes √† des APIs externes

----

### Plugins QField: exemples - 2/3

- [Weather Forecast plugin](https://github.com/opengisch/qfield-weather-forecast)

![√âcran du plugin Weather Forecast dans QField](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/qfield_plugin_weather_forecast.webp){ height="400" }

- Avoir la visu des pr√©dictions m√©t√©o dans QField (Open-Meteo)

----

### Plugins QField: exemples - 3/3

- Plugin "Christmas Theme"

![√âcran du plugin Christmas Theme dans QField](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/qfield_plugin_christmas_theme.webp){ height="400" }

- Customiser et "brander" l'interface de QField

----

### QField Plugins Framework

- En l'√©tat: documentation pas forc√©ment triviale √† utiliser (d√©p√¥t GitHub)
- [_Cookbook_](https://docs.qfield.org/reference/plugins/) pour le d√©veloppement de plugins QField
- Pr√©vu d'am√©liorer la doc sur d'ici fin 2025
- Travaux en cours sur un d√©p√¥t de plugins QField -> plus simple √† installer

----

### :speech_balloon: Demo

<iframe
  src="https://video.osgeo.org/videos/embed/hAuB4Ze4gE2fgq9upbdxGm"
  style="width: 100%; aspect-ratio: 16 / 9;"
  frameborder="0"
  allowfullscreen
  sandbox="allow-same-origin allow-scripts allow-popups">
</iframe>

----

### Et maintenant ?

- Quelques personnes sur QChat, parfois...
- On fix des bugs, parfois...
- _Test coverage_ du serveur: `~94%` :smirk: :sunglasses: (< 500 lignes de code)
- Plugin am√©lior√© gr√¢ce aux retours des utilisateurs

----

### Retour d'exp√©rience

- Sympa de se frotter et d'√©prouver la robustesse de QGIS / Qt (websockets, etc).
- D√©couverte du framework de plugins QField :+1:
- Un peu l'impression d'avoir fait son protocole de messagerie dans son coin...

----

### Et la suite ?

- Cr√©er et publier un plugin appel√© "`QChat`" sur le d√©p√¥t officiel
- Cr√©er des compatibilit√©s / "bridges" avec les serveurs `matrix` (complexe !)
- D'autres trucs sympa: des emojis, des sons, des "threads", des easter eggs...
- Une interface graphique plus fluide avec du QML -> partage de code entre les plugins QGIS et QField
- Partager des mod√®les graphiques ? Partager du code `pyqgis` ?
-> QGIS Remote Desktop - support & assistance

----

### Merci

![cow](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/cow.png)

C'est le moment du quizz !

----

### :question: Quizz :question:

3 mani√®res de participer:

- dans QGIS, avec QChat dans le plugin `QTribu`
- dans QField, avec le plugin QChat - URL: [`https://github.com/geotribu/qchat-qfield-plugin/releases/download/0.1.0/qfield-plugin-qchat.zip`](https://github.com/geotribu/qchat-qfield-plugin/releases/download/0.1.0/qfield-plugin-qchat.zip)
- dans un navigateur: [`gischat.geotribu.net`](https://gischat.geotribu.net)

![QR code QChat web](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/gischat_web_qrcode.webp){ height="300" }

----

### :question: Quizz :question:

En quelle ann√©e a √©t√© cr√©√© QGIS ?

_Indice: le mur de Berlin √©tait d√©j√† tomb√©, mais QGIS IV n'√©tait pas encore sorti._

----

### :question: Quizz :question:

√Ä 10 000 pr√®s, combien de commits y-a-t'il √† date sur le d√©p√¥t QGIS ?

_Indice: plus que le nombre de personnes qui utilisent ArqMap, moins que le nombre de code d'erreurs possibles dans ArcGisse._

----

### :question: Quizz :question:

Combien existe-t-il √† date de plugins QField ?

_c.√†.d. nombre de d√©p√¥ts GitHub avec le tag `qfield-plugin`._

_Indice:_

```math
\left( \frac{7!}{(3! \cdot 2^3)} - \int_{0}^{1} e^x \, dx + \ln(e^2) \right) + \left( \frac{1}{2} \cdot \sqrt{36} \right)
```

----

### :question: Quizz :question:

Combien de d√©p√¥ts publics contient l'organisation GitHub Geotribu ?

_Indice: entre 0 et 1 million._

----

### :question: Quizz :question:

De quelle ann√©e date le premier article dans Geotribu ?

_Indice: cette ann√©e-l√†, Johnny chantait "√áa n'finira jamais"._

----

### Merci

![dog](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/dog.png)

_Remerciement sp√©cial √† [@nirvn](https://github.com/nirvn) :thumbsup:_

√Ä l'avenir, n'h√©sitez pas √† passer une t√™te dans QChat !
