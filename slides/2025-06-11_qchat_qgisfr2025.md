---
date: 2025-06-11
title: QChat, un tchat dans QGIS et QField
transition: slide
theme: dark
---

## QChat

:speech_balloon: Un tchat dans QGIS et QField

![cat](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/cat.png)

**#QGISFR2025** - 11 Juin 2025 - Avignon

_Guilhem Allaman - Geotribu - OPENGIS.ch_

----

### Comment ça a commencé

Un jour... En juillet 2024...

![Un jardin bien vert avec un chien au premier plan](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/garden.jpeg)

----

### :phone: Coup de fil avec Julien Moura (complice de Geotribu)

- Et si on tchattait dans QField ?
- Et si on tchattait dans QField **et** dans QGIS ?
- Mais... Pourquoi, en fait !?
- Et pourquoi pas ?

Inutile, donc indispensable !

----

### Commençons par un plugin QGIS

Plugin QGIS [QTribu](https://plugins.qgis.org/plugins/qtribu/):

- fonctionnel
- enregistré sur `plugins.qgis.org`
- CICD opérationnelle

![QTribu sur plugins.qgis.org](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/qtribu_qgis_plugin.png)

_Fun fact: le plugin QTribu a été créé un 1er avril..._

----

### QChat au début

- Étudier les standards ouverts de chat déjà existants (IRC, jabber, matrix...)  
-> Commençons simple, "Keep it simple", [K.I.S.S.](https://en.wikipedia.org/wiki/KISS_principle) :kissing_heart:
- Ouvert et accessible pour tout un chacun  
-> T'as un QGIS -> Tu peux tchatter :speech_balloon:

----

### Développement du plugin QGIS QTribu

- Au début: le méchanisme `LISTEN` / `NOTIFY` de PostgreSQL considéré
- Choix: connexions de websockets au server -> `QtWebSockets` disponible en `pyqgis` :thumbsup:
- Paramètres [en utilisant le templater de plugins QGIS](https://oslandia.gitlab.io/qgis/template-qgis-plugin/)
- `QgsDockWidget` -> fluide et en parallèle du canvas de QGIS

----

### Fonctionnalités

- Envoyer des messages textes aux autres utilisateur/trices
- Incarner _jusqu'au bout de ses ongles_ un _avatar_ (icônes natives de QGIS)
- Mentionner les autres utilisateur/trices avec `@jane_doe` / `@all`
- Notifications: barre des messages de QGIS, sons...
- Liker des messages :thumbsup:
- Partager des données vecteur légères via `geojson`
- Partager des images et des screenshots du canvas QGIS
- Partager des projections, des bbox

----

### Serveur QChat

- "gischat": [dépôt sur GitHub](https://github.com/geotribu/gischat) #gischat
- En python avec _FastAPI_
- Dispatcher de websockets
- Pas de bases de données: simplement des websockets _stateless_ :kissing_heart:
- Image docker sur [DockerHub](https://hub.docker.com/r/gounux/gischat) et [GHCR](https://github.com/geotribu/gischat/pkgs/container/gischat)
- Déployable sur un serveur assez simplement  
-> 1 service + quelques variables d'environnement

----

### Instances de chat QChat / gischat

2 serveurs connus à l'heure actuelle:

- `gischat.geotribu.net`
-> pour tout le monde, en anglais
- `gischat.geotribu.fr`
-> pour tout le monde, en français

Aussi: :phone: [annuaire des instances connues et découvrables](https://github.com/geotribu/gischat/blob/main/instances.json) sur le dépôt GitHub

----

### Plugin QField

Possible grâce au _framework_ des plugins QField:

- Ajouter de la logique custom à l'appli QField
  - À l'échelle d'un projet, déployable avec QFieldCloud
  - À l'échelle de l'application (paramètres)
- JavaScript / QML (Qt Meta-object Language)

----

### Plugins QField: exemples

- [OSRM Routing plugin](https://github.com/opengisch/qfield-osrm)

![Écran du plugin OSRM Routing Plugin dans QField](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/qfield_plugin_osrm_routing.webp)

- Calculer un plus court chemin avec l'API OSRM (OpenStreetMap Germany)
- -> dynamique -> appel et requêtes à des APIs externes

----

### Plugins QField: exemples

- [Weather Forecast plugin](https://github.com/opengisch/qfield-weather-forecast)

![Écran du plugin Weather Forecast dans QField](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/qfield_plugin_weather_forecast.webp)

- Avoir la visu des prédictions météo dans QField (Open-Meteo)

----

### Plugins QField: exemples

- Plugin "Christmas Theme"

![Écran du plugin Christmas Theme dans QField](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/qfield_plugin_christmas_theme.webp)

- Customiser et "brander" l'interface de QField

----

### QField Plugins Framework

- En l'état: documentation pas forcément triviale à utiliser (dépôt GitHub)
- [_Cookbook_](https://docs.qfield.org/reference/plugins/) pour le développement de plugins QField
- Prévu d'améliorer la doc sur d'ici fin 2025
- Travaux en cours sur un dépôt de plugins QField -> plus simple à installer

----

### :speech_balloon: Demo

<iframe
  src="https://video.osgeo.org/videos/embed/hAuB4Ze4gE2fgq9upbdxGm"
  style="width: 100%; aspect-ratio: 16 / 9;"
  frameborder="0"
  allowfullscreen
  sandbox="allow-same-origin allow-scripts allow-popups">
</iframe>

----

### Et maintenant ?

- Quelques personnes sur QChat, parfois...
- On fix des bugs, parfois...
- Couverture de tests du serveur: `~94%` :smirk: :sunglasses:
- Plugin amélioré grâce aux retours des utilisateurs

----

### Retour d'expérience

- Sympa de se frotter et d'éprouver la robustesse de QGIS / Qt (websockets, etc).
- Découverte du framework de plugins QField :+1:
- Un peu l'impression d'avoir fait son protocole de messagerie dans son coin...

----

### Et la suite ?

- Créer des compatibilités / "bridges" avec les serveurs `matrix` (complexe !)
- Créer et publier un plugin appelé "`QChat`" sur le dépôt officiel
- D'autres trucs sympa: des emojis, des sons, des "threads", des easter eggs...
- Une interface graphique plus fluide avec du QML -> partage de code entre les plugins QGIS et QField

----

### Merci

![cow](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/cow.png)

:cow: C'est le moment du quizz :cow: !

----

### :question: Quizz :question:

3 manières de participer:

- dans QGIS, avec QChat dans le plugin `QTribu`
- dans QField, avec le plugin QChat (URL: `https://github.com/geotribu/qchat-qfield-plugin/releases/download/0.1.0/qfield-plugin-qchat.zip`)
- dans un navigateur: `gischat.geotribu.net`

![QR code QChat web](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/gischat_web_qrcode.webp)

----

### :question: Quizz :question:

En quelle année a été créé QGIS ?

_Indice: le mur de Berlin était déjà tombé, mais Nabila n'habitait pas encore à Doubailles._

----

### :question: Quizz :question:

À 10 000 près, combien de commits à date sur le dépôt QGIS ?

_Indice: plus que le nombre de personnes qui utilisent ArqMap, moins que le nombre de code d'erreurs possibles dans ArcGisse._

----

### :question: Quizz :question:

Combien existe-t-il à date de plugins QField ?

_(c.à.d. nombre de dépôts GitHub avec le tag `qfield-plugin`)_

_Indice:_

```math
\left( \frac{7!}{(3! \cdot 2^3)} - \int_{0}^{1} e^x \, dx + \ln(e^2) \right) + \left( \frac{1}{2} \cdot \sqrt{36} \right)
```

----

### :question: Quizz :question:

Combien de dépôts publics contient l'organisation GitHub Geotribu ?

_Indice: entre 0 et 1 million._

----

### :question: Quizz :question:

De quelle année date le premier article sur Geotribu ?

_Indice: cette année-là, Johnny chantait "Ça n'finira jamais"_

----

### Merci

![dog](https://cdn.geotribu.fr/img/articles-blog-rdp/articles/2024/qchat/prez/dog.png)

_Remerciement spécial à @nirvn :thumbsup:_

À l'avenir, n'hésitez pas à passer une tête dans QChat !
